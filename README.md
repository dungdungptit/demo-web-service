# FASTAPI_BASE

## Source Library

Đây là phiên bản Backend base từ framework FastAPI. Trong code base này đã cấu hình sẵn

- FastAPI
- Postgresql(>=14)
- Alembic
- API Login
- API CRUD User, API Get Me & API Update Me
- Pagination
- Authen/Authorize với JWT
- Permission_required & Login_required
- Logging
- Pytest

## Cấu trúc project

```txt
.dd
├── alembicdd
│   ├── versions    // thư mục chứa file migrationsdd
│   └── env.pydd
├── appdd
│   ├── api         // các file api được đặt trong nàydd
│   ├── core        // chứa file config load các biến env & function tạo/verify JWT access-tokendd
│   ├── db          // file cấu hình make DB sessiondd
│   ├── helpers     // các function hỗ trợ như login_manager, pagingdd
│   ├── models      // Database model, tích hợp với alembic để auto generate migrationdd
│   ├── schemas     // Pydantic Schemadd
│   ├── services    // Chứa logic CRUD giao tiếp với DBdd
│   └── main.py     // cấu hình chính của toàn bộ projectdd
├── testsdd
│   ├── api         // chứa các file test cho từng apidd
│   ├── faker       // chứa file cấu hình faker để tái sử dụngdd
│   ├── .env        // config DB testdd
│   └── conftest.py // cấu hình chung của pytestdd
├── .gitignoredd
├── alembic.inidd
├── docker-compose.ymldd
├── Dockerfiledd
├── .env.exampledd
├── logging.ini     // cấu hình loggingdd
├── pytest.ini      // file setup cho pytestdd
├── README.mddd
└── requirements.txt    // file chứa các thư viện để cài đặt qua pip install
```

## Migration

Migration là một tính năng cho phép bạn thay đổi cả cấu trúc và dữ liệu trong database.

Thay vì thay đổi trực tiếp vào database thì project FastAPI này sử dụng alembic để thực hiện việc thay đổi các table

```python
# alembic/versions/f9a075ca46e9_.py

...
def upgrade():
    # ### commands auto generated by Alembic - please adjust! ###
    op.create_table('user',
        sa.Column('id', sa.Integer(), autoincrement=True, nullable=False),
        sa.Column('full_name', sa.String(), nullable=True),
        sa.Column('email', sa.String(), nullable=True),
        sa.Column('hashed_password', sa.String(length=255), nullable=True),
        sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_user_email'), 'user', ['email'], unique=True)
    op.create_index(op.f('ix_user_full_name'), 'user', ['full_name'], unique=False)
    # ### end Alembic commands ###


def downgrade():
    # ### commands auto generated by Alembic - please adjust! ###
    op.drop_index(op.f('ix_user_full_name'), table_name='user')
    op.drop_index(op.f('ix_user_email'), table_name='user')
    op.drop_table('user')
    # ### end Alembic commands ###
...
```
